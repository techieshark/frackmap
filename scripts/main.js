"use strict";!function(){function t(t){return t.frequency=+t.frequency,t.year=+t.year,t}var a=window.d3,e={top:20,right:20,bottom:30,left:40},r=760-e.left-e.right,n=250-e.top-e.bottom,o=a.scale.linear().range([n,0]),i=a.svg.axis().scale(o).orient("left"),c=a.select("body").append("svg").attr("class","chart").attr("width",r+e.left+e.right).attr("height",n+e.top+e.bottom).append("g").attr("transform","translate("+e.left+","+e.top+")"),s=function(t){return""+t.year},d=function(t,a,e,r){var n=250,o="\n                M 0,"+r+" "+a+","+r+"\n                C "+a+","+r+" "+a+","+(r+e)+" "+a+","+(r+e)+"\n                l -"+a+",0\n                C 0,"+(r+e)+" 0,"+r+" 0,"+r+"\n                Z",i=.25*a,c="\n                M 0,"+r+" "+a+","+r+"\n                C "+(a+i)+","+(r+.3*e)+" "+(a+i)+","+(r+.7*e)+" "+a+","+(r+e)+"\n                l -"+a+",0\n                C "+(0-i)+","+(r+.7*e)+" "+(0-i)+","+(r+.3*e)+" 0,"+r+"\n                Z",s="\n                M 0,0 "+a+",0\n                C "+a+",0 "+a+",1 "+a+",1\n                l -"+a+",0\n                C 0,1 0,0 0,0\n                Z";return t.append("path").attr("class","bulge").attr("d",o).transition().delay(0).duration(n).attr("d",c).transition().duration(n).ease("elastic").attr("d",o).transition().ease("cubic-out").duration(1e3).attr("d",s).style("fill-opacity",.5).remove()};window.addChart=function(e){a.tsv("data/frack-data.tsv",t,function(t,l){if(t)throw t;var u=.2,p=.1,f=a.scale.ordinal().domain(l.map(s)).rangeRoundBands([0,r],p,u),y=a.svg.axis().scale(f).orient("bottom");o.domain([0,a.max(l,function(t){return t.frequency})]),c.append("g").attr("class","x axis").attr("transform","translate(0,"+(n+2)+")").call(y),c.append("g").attr("class","y axis").call(i).append("text").attr("transform","rotate(-90)").attr("y",12).style("text-anchor","end").text("Frequency"),c.selectAll(".bar").data(l).enter().append("g").attr("transform",function(t){return"translate("+f(s(t))+",0)"}).attr("class","bar");var g=c.selectAll(".bar"),h=function(t){return n-o(t.frequency)},m=function(t){return o(t.frequency)};g.append("rect").attr("width",f.rangeBand()).attr("y",n).attr("height",0).transition().duration(300).delay(function(t,a){return 1e3*a}).attr("y",m).attr("height",h).each("end",function(t){var r=a.select(this.parentNode);d(r,f.rangeBand(),h(t),m(t)),r.transition().delay(400).attr("class","bar emptied").each("end",function(t){e(t)})}),g.append("text").text(function(t){return t.frequency}).attr("x",function(){var t=this.getBBox().width;return f.rangeBand()/2-t/2}).attr("y",function(t){var a=this.getBBox().height;return o(t.frequency)-a}).attr("dy",".75em")})}}(),function(){var t=window.mapboxgl,a=window.d3,e=window.addChart;t.accessToken="pk.eyJ1IjoidGVjaGllc2hhcmsiLCJhIjoiY2lrcTUxZmJvMTkweHRubTZlOGt5MnZzeiJ9.CxxVSVIPSsgFFL3Dx-QTbA";var r=new t.Map({container:"map",style:"mapbox://styles/techieshark/cikw6xfu100d098kmu3ogo74t",center:[-94.5,35],zoom:3});window.mapboxMap=r,r.on("style.load",function(){var t="./data/Fracking_Calendar.geojson";a.json(t,function(a,n){return a?void console.error("Error acquiring map data source "+t+": "+a):(n.features=n.features.map(function(t){return t.properties.year=new Date(t.properties["Full Date"]).getFullYear(),t}),r.addSource("locations",{type:"geojson",data:n}),r.addLayer({id:"points",type:"circle",source:"locations",paint:{"circle-radius":5,"circle-color":"rgba(55,148,179,0.8)"}}),r.setFilter("points",["<","year",2e3]),void e(function(t){console.log("emptied bar for year "+t.year),r.setFilter("points",["<=","year",t.year])}))})})}();